<html>
<head>
    <title>i18n</title>
    <script type="text/javascript" src="https://cdn.firebase.com/js/client/1.0.21/firebase.js"></script>
    <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js'></script>
    <script type="text/javascript" src="js/moment.js"></script>
    <script type="text/javascript" src="js/locale.min.js"></script>
    <script type="text/javascript" src="js/messageformat.js"></script>
    <script>document.write('<script src="' + (localStorage.getItem('lang') || 'en-GB') + '/i18n.js"><\/script>')</script>
    <link rel="stylesheet" href="css/main.css"></link>
</head>

<body>
  <input type="button" value="German" name="de" />
  <input type="button" value="French" name="fr" />
  <input type="button" value="English - GB" name="en-GB" />
  <input type="button" value="English - US" name="en-US" />
  <input type="button" value="Spanish" name="es" />
  <h1 id="header">Harry Potter </h1>
  <div id="content">
  </div>
<script>
  //Globals
  $('input').click(function(e){
      e.preventDefault();
      var $target = $(e.target);
      var lang = $target.attr('name');
      localStorage.setItem('lang', lang);
      location.reload();
  });

  var language = localStorage.getItem('lang');

  var dates = {
    'one': 867283200, 
    'two': 899347779, 
    'three': 931402179
  };

  moment.locale(language);

  //Bookstore
  $('<span>').text(window.i18n['bookstore'].store()).appendTo($('#header'));

  //Get cost
  var cost = parseInt(window.i18n['cost'].cost());
  var currency = window.i18n['cost'].currency();
  var formattedCost = cost.toLocaleString(language, {style: 'currency', currency: currency});

  //GET Book DATA
  for (var i in window.i18n['titles']) {

    $('<div class="book" id="book-' + i + '">').appendTo($('#content'));

    var titlefn = window.i18n['titles'][i];
    var text = titlefn();
    $('<div class="title">').text(text).appendTo($('#book-' + i));

    var coverfn = window.i18n['covers'][i];
    var src = coverfn();
    $('<img class="cover">').attr({'src': src, 'class': 'covers'}).appendTo($('#book-' + i));

    var formattedDate = moment(dates[i], "X").format("LL");
    $('<div class="date">').text(formattedDate).appendTo($('#book-' + i));

    $('<div class="cost">').text(formattedCost).appendTo($('#book-' + i));
  }



// function stripTags(str) {
//   return str.replace(/(<([^>]+)>)/ig,"");
// }

</script>
</body>
</html>